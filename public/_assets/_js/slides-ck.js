/*
  Google HTML5 slides template

  Authors: Luke Mah√© (code)
           Marcin Wichary (code and design)

           Dominic Mazzoni (browser compatibility)
           Charles Chen (ChromeVox support)

  URL: http://code.google.com/p/html5slides/
*/function getSlideEl(e){return e<0||e>=slideEls.length?null:slideEls[e]}function updateSlideClass(e,t){var n=getSlideEl(e);if(!n)return;t&&n.classList.add(t);for(var r in SLIDE_CLASSES)t!=SLIDE_CLASSES[r]&&n.classList.remove(SLIDE_CLASSES[r])}function updateSlides(){for(var e=0;e<slideEls.length;e++)switch(e){case curSlide-2:updateSlideClass(e,"far-past");break;case curSlide-1:updateSlideClass(e,"past");break;case curSlide:updateSlideClass(e,"current");break;case curSlide+1:updateSlideClass(e,"next");break;case curSlide+2:updateSlideClass(e,"far-next");break;default:updateSlideClass(e)}triggerLeaveEvent(curSlide-1);triggerEnterEvent(curSlide);window.setTimeout(function(){disableSlideFrames(curSlide-2)},301);enableSlideFrames(curSlide-1);enableSlideFrames(curSlide+2);isChromeVoxActive()&&speakAndSyncToNode(slideEls[curSlide]);updateHash()}function buildNextItem(){var e=slideEls[curSlide].querySelectorAll(".to-build");if(!e.length)return!1;e[0].classList.remove("to-build","");isChromeVoxActive()&&speakAndSyncToNode(e[0]);return!0}function prevSlide(){if(curSlide>0){curSlide--;updateSlides()}}function nextSlide(){if(buildNextItem())return;if(curSlide<slideEls.length-1){curSlide++;updateSlides()}}function triggerEnterEvent(e){var t=getSlideEl(e);if(!t)return;var n=t.getAttribute("onslideenter");n&&(new Function(n)).call(t);var r=document.createEvent("Event");r.initEvent("slideenter",!0,!0);r.slideNumber=e+1;t.dispatchEvent(r)}function triggerLeaveEvent(e){var t=getSlideEl(e);if(!t)return;var n=t.getAttribute("onslideleave");n&&(new Function(n)).call(t);var r=document.createEvent("Event");r.initEvent("slideleave",!0,!0);r.slideNumber=e+1;t.dispatchEvent(r)}function handleTouchStart(e){if(e.touches.length==1){touchDX=0;touchDY=0;touchStartX=e.touches[0].pageX;touchStartY=e.touches[0].pageY;document.body.addEventListener("touchmove",handleTouchMove,!0);document.body.addEventListener("touchend",handleTouchEnd,!0)}}function handleTouchMove(e){if(e.touches.length>1)cancelTouch();else{touchDX=e.touches[0].pageX-touchStartX;touchDY=e.touches[0].pageY-touchStartY}}function handleTouchEnd(e){var t=Math.abs(touchDX),n=Math.abs(touchDY);t>PM_TOUCH_SENSITIVITY&&n<t*2/3&&(touchDX>0?prevSlide():nextSlide());cancelTouch()}function cancelTouch(){document.body.removeEventListener("touchmove",handleTouchMove,!0);document.body.removeEventListener("touchend",handleTouchEnd,!0)}function disableSlideFrames(e){var t=getSlideEl(e);if(!t)return;var n=t.getElementsByTagName("iframe");for(var r=0,i;i=n[r];r++)disableFrame(i)}function enableSlideFrames(e){var t=getSlideEl(e);if(!t)return;var n=t.getElementsByTagName("iframe");for(var r=0,i;i=n[r];r++)enableFrame(i)}function disableFrame(e){e.src="about:blank"}function enableFrame(e){var t=e._src;e.src!=t&&t!="about:blank"&&(e.src=t)}function setupFrames(){var e=document.querySelectorAll("iframe");for(var t=0,n;n=e[t];t++){n._src=n.src;disableFrame(n)}enableSlideFrames(curSlide);enableSlideFrames(curSlide+1);enableSlideFrames(curSlide+2)}function setupInteraction(){var e=document.createElement("div");e.className="slide-area";e.id="prev-slide-area";e.addEventListener("click",prevSlide,!1);document.querySelector("section.slides").appendChild(e);var e=document.createElement("div");e.className="slide-area";e.id="next-slide-area";e.addEventListener("click",nextSlide,!1);document.querySelector("section.slides").appendChild(e);document.body.addEventListener("touchstart",handleTouchStart,!1)}function isChromeVoxActive(){return typeof cvox=="undefined"?!1:!0}function speakAndSyncToNode(e){if(!isChromeVoxActive())return;cvox.ChromeVox.navigationManager.switchToStrategy(cvox.ChromeVoxNavigationManager.STRATEGIES.LINEARDOM,0,!0);cvox.ChromeVox.navigationManager.syncToNode(e);cvox.ChromeVoxUserCommands.finishNavCommand("");var t=e;while(t.firstChild)t=t.firstChild;cvox.ChromeVox.navigationManager.syncToNode(t)}function speakNextItem(){if(!isChromeVoxActive())return;cvox.ChromeVox.navigationManager.switchToStrategy(cvox.ChromeVoxNavigationManager.STRATEGIES.LINEARDOM,0,!0);cvox.ChromeVox.navigationManager.next(!0);if(!cvox.DomUtil.isDescendantOfNode(cvox.ChromeVox.navigationManager.getCurrentNode(),slideEls[curSlide])){var e=slideEls[curSlide];while(e.firstChild)e=e.firstChild;cvox.ChromeVox.navigationManager.syncToNode(e);cvox.ChromeVox.navigationManager.next(!0)}cvox.ChromeVoxUserCommands.finishNavCommand("")}function speakPrevItem(){if(!isChromeVoxActive())return;cvox.ChromeVox.navigationManager.switchToStrategy(cvox.ChromeVoxNavigationManager.STRATEGIES.LINEARDOM,0,!0);cvox.ChromeVox.navigationManager.previous(!0);if(!cvox.DomUtil.isDescendantOfNode(cvox.ChromeVox.navigationManager.getCurrentNode(),slideEls[curSlide])){var e=slideEls[curSlide];while(e.lastChild)e=e.lastChild;cvox.ChromeVox.navigationManager.syncToNode(e);cvox.ChromeVox.navigationManager.previous(!0)}cvox.ChromeVoxUserCommands.finishNavCommand("")}function getCurSlideFromHash(){var e=parseInt(location.hash.substr(1));e?curSlide=e-1:curSlide=0}function updateHash(){location.replace("#"+(curSlide+1))}function handleBodyKeyDown(e){switch(e.keyCode){case 39:case 13:case 32:case 34:nextSlide();e.preventDefault();break;case 37:case 8:case 33:prevSlide();e.preventDefault();break;case 40:isChromeVoxActive()?speakNextItem():nextSlide();e.preventDefault();break;case 38:isChromeVoxActive()?speakPrevItem():prevSlide();e.preventDefault()}}function addEventListeners(){document.addEventListener("keydown",handleBodyKeyDown,!1)}function addPrettify(){var e=document.querySelectorAll("pre");for(var t=0,n;n=e[t];t++)n.classList.contains("noprettyprint")||n.classList.add("prettyprint");var n=document.createElement("script");n.type="text/javascript";n.src=PERMANENT_URL_PREFIX+"prettify.js";n.onload=function(){prettyPrint()};document.body.appendChild(n)}function addFontStyle(){var e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|Droid+Sans+Mono";document.body.appendChild(e)}function addGeneralStyle(){var e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.href="/_assets/_css/styles.css";document.body.appendChild(e);var e=document.createElement("meta");e.name="viewport";e.content="width=1100,height=750";document.querySelector("head").appendChild(e);var e=document.createElement("meta");e.name="apple-mobile-web-app-capable";e.content="yes";document.querySelector("head").appendChild(e)}function makeBuildLists(){for(var e=curSlide,t;t=slideEls[e];e++){var n=t.querySelectorAll(".build > *");for(var r=0,i;i=n[r];r++)i.classList&&i.classList.add("to-build")}}function handleDomLoaded(){slideEls=document.querySelectorAll("section.slides > article");setupFrames();addFontStyle();addGeneralStyle();addPrettify();addEventListeners();updateSlides();setupInteraction();makeBuildLists();document.body.classList.add("loaded")}function initialize(){getCurSlideFromHash();window._DEBUG&&(PERMANENT_URL_PREFIX="../");window._DCL?handleDomLoaded():document.addEventListener("DOMContentLoaded",handleDomLoaded,!1)}var PERMANENT_URL_PREFIX="http://html5slides.googlecode.com/svn/trunk/",SLIDE_CLASSES=["far-past","past","current","next","far-next"],PM_TOUCH_SENSITIVITY=15,curSlide;typeof document!="undefined"&&!("classList"in document.createElement("a"))&&function(e){var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object;strTrim=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},arrIndexOf=Array[n].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},DOMEx=function(e,t){this.name=e;this.code=DOMException[e];this.message=t},checkTokenAndGetIndex=function(e,t){if(t==="")throw new DOMEx("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new DOMEx("INVALID_CHARACTER_ERR","String contains an invalid character");return arrIndexOf.call(e,t)},ClassList=function(e){var t=strTrim.call(e.className),n=t?t.split(/\s+/):[];for(var r=0,i=n.length;r<i;r++)this.push(n[r]);this._updateClassName=function(){e.className=this.toString()}},classListProto=ClassList[n]=[],classListGetter=function(){return new ClassList(this)};DOMEx[n]=Error[n];classListProto.item=function(e){return this[e]||null};classListProto.contains=function(e){e+="";return checkTokenAndGetIndex(this,e)!==-1};classListProto.add=function(e){e+="";if(checkTokenAndGetIndex(this,e)===-1){this.push(e);this._updateClassName()}};classListProto.remove=function(e){e+="";var t=checkTokenAndGetIndex(this,e);if(t!==-1){this.splice(t,1);this._updateClassName()}};classListProto.toggle=function(e){e+="";checkTokenAndGetIndex(this,e)===-1?this.add(e):this.remove(e)};classListProto.toString=function(){return this.join(" ")};if(i.defineProperty){var s={get:classListGetter,enumerable:!0,configurable:!0};try{i.defineProperty(r,t,s)}catch(o){if(o.number===-2146823252){s.enumerable=!1;i.defineProperty(r,t,s)}}}else i[n].__defineGetter__&&r.__defineGetter__(t,classListGetter)}(self);if(!window._DEBUG&&document.location.href.indexOf("?debug")!==-1){document.addEventListener("DOMContentLoaded",function(){window._DCL=!0},!1);window._DEBUG=!0;var script=document.createElement("script");script.type="text/javascript";script.src="/_assets/_js/slides.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(script,s);s.parentNode.removeChild(s)}else initialize();